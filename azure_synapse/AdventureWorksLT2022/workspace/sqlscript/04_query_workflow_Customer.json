{
	"name": "04_query_workflow_Customer",
	"properties": {
		"folder": {
			"name": "AdventureWorksLT2022"
		},
		"content": {
			"query": "Use AdventureWorksLT2022_DB;\nGO;\n\n--------------------- Start bronze layer ---------------------\nIF (SELECT OBJECT_ID('bronze.Customer', 'U')) IS NOT NULL\n    DROP EXTERNAL TABLE bronze.Customer;\n\nCREATE EXTERNAL TABLE bronze.Customer\n(\n    CustomerID INT NULL,\n    NameStyle BIT NULL,\n    Title NVARCHAR(8) NULL,\n    FirstName NVARCHAR(50) NULL,\n    MiddleName NVARCHAR(50) NULL,\n    LastName NVARCHAR(50) NULL,\n    Suffix NVARCHAR(10) NULL,\n    CompanyName NVARCHAR(128) NULL,\n    SalesPerson NVARCHAR(256) NULL,\n    EmailAddress NVARCHAR(50) NULL,\n    Phone NVARCHAR(25) NULL,\n    PasswordHash VARCHAR(128) NULL,\n    PasswordSalt VARCHAR(10) NULL,\n    rowguid UNIQUEIDENTIFIER NULL,\n    ModifiedDate DATETIME NULL\n)\nWITH\n(\n    DATA_SOURCE = bronze_data,\n    LOCATION = 'Customer/*.parquet',\n    FILE_FORMAT = ParquetFormat\n);\n--------------------- End bronze layer ---------------------\n\n--------------------- Start silver layer ---------------------\n-- Cleaning\nDROP VIEW IF EXISTS silver.vw_Customer_Clean;\n\nCREATE VIEW silver.vw_Customer_Clean\nAS\nSELECT\n\tCustomerID,\n\tUPPER(TRIM(ISNULL(Title, ''))) AS Title,\n\tUPPER(TRIM(FirstName)) AS FirstName,\n\tUPPER(TRIM(ISNULL(MiddleName, ''))) AS MiddleName,\n\tUPPER(TRIM(LastName)) AS LastName,\n\tUPPER(TRIM(ISNULL(Suffix, ''))) AS Suffix,\n\tUPPER(TRIM(ISNULL(CompanyName, ''))) AS CompanyName,\n\tUPPER(TRIM(ISNULL(SalesPerson, ''))) AS SalesPerson,\n\tUPPER(TRIM(ISNULL(EmailAddress, ''))) AS EmailAddress,\n\tUPPER(TRIM(ISNULL(Phone, ''))) AS Phone\nFROM bronze.Customer;\n\n-- Materialization\nIF (SELECT OBJECT_ID('silver.Customer', 'U')) IS NOT NULL\n    DROP EXTERNAL TABLE silver.Customer;\n\nCREATE EXTERNAL TABLE silver.Customer\n    WITH (\n        LOCATION = 'Customer/',\n        DATA_SOURCE = silver_data,\n        FILE_FORMAT = ParquetFormat\n    )\nAS\nSELECT\n\tCustomerID,\n\tTitle,\n\tFirstName,\n\tMiddleName,\n\tLastName,\n\tSuffix,\n\tCompanyName,\n\tSalesPerson,\n\tEmailAddress,\n\tPhone\nFROM silver.vw_Customer_Clean;\n--------------------- End silver layer ---------------------\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "AdventureWorksLT2022_DB",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}